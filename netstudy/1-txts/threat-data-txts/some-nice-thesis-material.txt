We theorize about multiple definitions, and then thrive to confirm this theory with actual data. If it doesn't comply with some parts, we'll analyze why it is not like that.

All of the information below implies a limited analysis timeframe.

1. BENIGN
1.1. Source of traffic
In the CIC-IDS-2017 benign traffic, we used all benign traffic from Monday to Friday to generate benign network objects. We analyzed the generated benign flows and talkers and found out that 24 of 61443 talkers presented 177 or more unique destination ports, while the remaining 61419 talkers presented 12 or less unique destination ports. We removed all traffic related to the 24 anomolous talkers, thus maintaining the property of having a low number of unique destination ports by benign talker. As such, we recalculated all benign network objects with the following 24 talkers removed:
	- "172.16.0.1-192.168.10.50-TCP"
	- "192.168.10.12-192.168.10.50-TCP"
	- "192.168.10.14-192.168.10.50-TCP"
	- "192.168.10.15-192.168.10.50-TCP"
	- "192.168.10.16-192.168.10.50-TCP"
	- "192.168.10.17-192.168.10.50-TCP"
	- "192.168.10.19-192.168.10.50-TCP"
	- "192.168.10.25-192.168.10.50-TCP"
	- "192.168.10.5-192.168.10.50-TCP"
	- "192.168.10.51-185.170.48.239-TCP"
	- "192.168.10.8-192.168.10.50-TCP"
	- "192.168.10.9-192.168.10.50-TCP"
	- "192.168.10.51-192.168.10.50-TCP"
	- "172.16.0.1-192.168.10.51-TCP"
	- "192.168.10.8-192.168.10.12-TCP"
	- "192.168.10.8-192.168.10.14-TCP"
	- "192.168.10.8-192.168.10.15-TCP"
	- "192.168.10.8-192.168.10.16-TCP"
	- "192.168.10.8-192.168.10.17-TCP"
	- "192.168.10.8-192.168.10.19-TCP"
	- "192.168.10.8-192.168.10.25-TCP"
	- "192.168.10.8-192.168.10.5-TCP"
	- "192.168.10.8-192.168.10.51-TCP"
	- "192.168.10.8-192.168.10.9-TCP"

After applying the above filter, the following destination ports remained in the dataset:
- 53: DNS port (dns)
- 80: HTTP port (http)
- 88: Kerberos port (kerberos)
- 135: RPC port (msrpc)
- 139: SMB NetBios Session Service port (netbios-ssn)
- 389: LDAP Server port (ldap)
- 443: HTTPS port (https)
- 444: WEBEX port (webex); SNPP port (snpp)
- 445: SMB directly over TCP/IP port (microsoft-ds)
- 465: SMTPS port (smtps)
- 3268: Global Catalog port (msft-gc)
- 4292: VRML Multi User Systems port (vrml-multi-use)
- 8080: Alternative HTTP port (http-alt)
- 8443: alternative HTTPS port (https-alt)
- RPC randomly allocated high TCP port (1024-5000 and 49152-65535 ports): 49184, 49187, 49202, 49347, 49457, 49465, 49466, 49666, 49671, 49814, 49900, 49988, 50235, 51927
- NOTE: We went to multiple sources (like IANA, speedguide.net and other sources found on Google), to determine the well-known ports' correspondent network services. However, please note that port-based rules cannot be trusted alone for detection purposes due to the ease of deploying adversarial models that would defeat this type of detection (e.g. a reverse-shell using port 80 to evade detection). Instead, we only use ports to determine information about the network services and protocols in use on the CIC-IDS-2017 dataset, which was created in a controlled lab environment and did not use evasion techniques, but rather used network protocols in their expected ports.

Originally, the benign dataset had: 61443 talkers, 18880 hosts
By applying the above filter, we now have: 509111 flows, 61426 talkers, 18879 hosts
50911 flows in 

1.1. A benign talker will, usually, present a low number of flows.
Host A will only communicate with host B to obtain what it wants from B, which should happen using a small set of flows. Host A may talk to multiple other hosts, using small sets of flows for each one, due to benign activities such as browsing websites. Examples of human behavior that may cause a low number of flows are:
- Browsing the web and performing http/https connections to websites
- Uploading/downloading files to/from a remote host
- Accessing and using network services (e.g. ssh, ftp, smtp)

An important exception to this rule is network behavior which is automated. Automated network behavior will likely still create a lot of flows. Examples of benign applications which cause this type of behavior are applications which periodically upload analytics data to remote servers, as well as other network programs and protocols running in the network. Despite that, most automated network traffic also uses a small set of flows to allow a host A to communicate with a host B, the difference is that it does it more consistently often than benign traffic generated by a human user.

CIC-IDS-2017 shows some talkers that present a high number of flows: this happens because the authors of the dataset automatized the creation of their benign traffic using their Benign-Profiling system. The authors were likely not concerned with the fact that two hosts don't usually communicate too often between each other in a limited timeframe: this means that if the authors repeat 1 benign flow within a talker, they are stranding away from what a benign talker looks like, for the aforementioned reasons. We recognize that the authors' Benign-Profiling system seems great in maintaining the benignity of the flows (and, consequently, of the packets), as it is proved by the great flow classifications obtained looking only at the level of the flows and their packets: this, by itself, is a great achievement, because the "benign" class is a very broad class to correctly and completely capture and the authors have achieved, at least, the correctness part, which as a consequence leads to flow classification results being very good. However, since the authors were not concerned with maintaining the benignity of any higher network objects such as the talkers or the hosts, the dataset required some data cleaning to be correct at this level as well.


1.2. A benign talker will present a high number/rate of three-way handshake initiations. Requested connection initiations and two-way handshake initiations are low.
A benign host will only talk to another host when they positively respond to their connection request. A benign host will refrain from retrying failed connections too often. Even so, the host may maintain the same flow when retrying and, other times, it may create a new one.

1.3. A benign talker will present a low number/rate of unique destination ports contacted.
The only way that a benign talker presents a high number of unique destination ports is if there is a host which is running a high number of network services at the same time and if another given host connects to and uses all of those services. Since this scenario is not usual, the number/rate of unique destination ports continues to be a good indicator of benign traffic.
This will not be considered a valid feature for determining benignity in the CIC-IDS-2017 dataset since we have already used it to transform our benign network objects.

