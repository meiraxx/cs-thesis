1. L2/L3/L3+/L4 Threat Class - Host Discovery (by means of service discovery)
1.1. L2 Threat - ARP Host Discovery
1.2. L3 Threat - IP Protocol Host Discovery
1.3. L3+ Threat - ICMP Host Discovery
1.4. L4 Threat - UDP Host Discovery
1.5. L4 Threat - TCP Host Discovery

Intent: Probe a network range or multiple selected hosts to find active hosts.

Known Technique(s):
- ARP Ping Scan (-sn -PR) - within a Local Area Network (LAN), the attacker sends an ARP request to a destination MAC address, which can either be a single MAC address, a multicast MAC address or the broadcast MAC address (the most common). If any device is listening on those channels, it will respond (given a normal system configuration) to the request with a valid MAC address associated with the IP, in accordance to its ARP table, given that default dynamic ARP table entries are enabled. This scan is very powerful to find hidden devices in a network, since ARP requests will very likely be responded to by whoever owns the requested information and is actively listening on those channels. In case of a response, we have confirmation that the host is active, unless the respondent host had ARP table entries that should already have expired or, in a more unusual case, if the respondent host was ARP spoofed. [1.1]
- IP Protocol Ping (-sn -PO) - for each host, the attacker sends multiple raw IP packets containing the IP protocol number in the IP header. For example, the attacker can send six raw IP packets, each containing a different protocol: ICMP (protocol 1), IGMP (protocol 2), IP-in-IP (protocol 4), TCP (protocol 6), UDP (protocol 17) and SCTP (protocol 132). This method looks for either responses using the same protocol (host supports protocol) or ICMP protocol unreachable messages (host doesn't support protocol), both indicating that the the target host is alive. [1.2]
- ICMP Echo Request Scan (-sn -PE) - for each host, the attacker sends an ICMP type 8 packet. If the host responds with an ICMP type 0 packet, it is up, else the host may be down or the packet was filtered. [1.3]
- ICMP Timestamp Request Scan (-sn -PP) - for each host, the attacker sends an ICMP type 13 packet. If the host responds with an ICMP type 14 packet, it is up, else the host may be down or the packet was filtered. [1.3]
- ICMP Information Request (does not exist in Nmap) - for each host, the attacker sends an ICMP type 15 packet. If the host responds with an ICMP type 16 packet, it is up, else the host may be down, this service is not implemented on the end device or the packet was filtered. [1.3]
- ICMP Address Mask Request Scan (-sn -PM) - for each host, the attacker sends an ICMP type 17 packets. If the host responds with an ICMP type 18 packet, it is up, else the host may be down, this service is not implemented on the end device or the packet was filtered. [1.3]
- UDP Ping Scan (-sn -PU) - for each host, the attacker sends a UDP request to one given port. If the host responds, the host is up, else the host may be down or the packet was filtered. [1.4]
- TCP SYN Ping Scan (-sn -PS) - for each host, the attacker sends a TCP request with the SYN flag activated to one test port. If the host responds with SYN-ACK or RST, the host is up, else the host may be down or the packet was filtered. [1.5]
- TCP ACK Ping Scan (-sn -PA) - for each host, the attacker sends a TCP request with the ACK flag activated to one test port. If the host responds with SYN-ACK or RST, the host is up, else the host may be down or the packet was filtered. [1.5]

Tool Applicability: Tools that can communicate over a network can eventually be used for host discovery, given that the protocols used to communicate are supported by the targeted machine. However, we will only consider a host discovery tool as such if it complies with at least one of the following conditions:
- It supports sending and interpreting ARP probes for multiple hosts
- It supports sending and interpreting IP-protocol probes (raw IP packets specifying the probed IP protocol number on the IP header) for multiple hosts
- It supports sending and interpreting TCP, UDP and ICMP probes for multiple hosts
Optionally, these tools can also support other protocols such as SCTP. Also, the existence of any L5-7 protocol is irrelevant for this category.
Tools:
<name> (<L1-4 protocols supported>)
NetDiscover (ARP)
UnicornScan - 1, 2, 3 (TCP, UDP, ICMP)
Nmap - 1, 2, 3 (ARP, raw IP, ICMP, UDP, TCP, SCTP)
Ncat - 1, 2, 3, 4, 5 (UDP, TCP, SCTP)
Hping3 - 1, 2, 3, 4 (raw IP, ICMP, UDP, TCP)
AngryIPScanner - 1, 2 (ICMP, UDP, TCP)
Masscan - 1, 2 (ICMP, UDP, TCP)
ZMap - 1, 2 (ICMP, UDP, TCP)

2. L4 Threat Class - Port Scan
2.1. L4 Threat - UDP Port Scan
2.2. L4 Threat - TCP Port Scan
2.3. L4 Threat - SCTP Port Scan

Intent: Probe multiple ports of a given host, for a given L4 protocol.

Known Technique(s):
- UDP Scan (-sU) - the attacker sends a UDP packet to each port. If the target responds with service data, the port is open. If the target does not respond, the port is either closed or filtered. [2.1]
- TCP Connect Scan - the attacker sends a TCP packet with the SYN flag bit set to each port. If the target responds with a SYN-ACK packet, the port is open and accepting requests: the attacker sends an ACK packet back; the target then responds with the service's specific data; then, the attacker sends a RST packet and closes the connection. If the target responds with a RST packet, the port is closed. Else, if the target does not respond, the port is filtered. [2.2]
- TCP SYN Scan (-sS) - the attacker sends a TCP packet with the SYN flag bit set to each port. If the target responds with SYN-ACK, the port is open and accepting requests: the attacker sends a RST packet to close the connection. If the target responds with a RST packet, the port is closed. Else, if the target does not respond, the port is filtered. [2.2]
- TCP ACK Scan (-sA) - the attacker sends a TCP packet with the ACK flag bit set to each port. If the target responds with a RST packet, the port is either open or closed, meaning that the port is unfiltered (not blocked by any firewall). Else, if the target does not respond or if it responds with certain ICMP error messages (type 3, code 0, 1, 2, 3, 9, 10 or 13), then the port is filtered. [2.2]
- TCP Null Scan (-sN) - the attacker sends a TCP packet with no flag set to each port. If the target responds with a RST packet, the port is considered closed. Else, if the target does not respond, the port is either open or filtered. Finally, if the target responds with an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10 or 13) then the port is filtered. [2.2]
- TCP Xmas Scan (-sX) - the attacker sends a TCP packet with the FIN, PSH and URG flag bits set to each port. If the target responds with a RST packet, the port is considered closed. Else, if the target does not respond, the port is either open or filtered. Finally, if the target responds with an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10 or 13) then the port is filtered. [2.2]
- TCP FIN Scan (-sF) - the attacker sends a TCP packet with the FIN flag bit set to each port. If the target responds with a RST packet, the port is considered closed. Else, if the target does not respond, the port is either open or filtered. Finally, if the target responds with an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10 or 13) then the port is filtered. [2.2]

Other known technique(s):
- TCP Window Scan (-sW) - this is not a technique that would alter the sent packet, rather an analysis technique for the other TCP port scans. The attacker may analyze the response packet to check whether a port is open: a positive window size indicates an open port and a zero size window indicates a closed port; if the response packet time to live (ttl) is lower than the rest of the received RST packets the port is likely to be open. This applies to most systems, but there are other systems that may return the inverse. [2.2]
- TCP Custom Scan (--scanflags) - the attacker sends a TCP packet with a custom set of TCP flag bits set to each port. The analysis depends on the TCP flag set used, as this means different possible responses and interpretations. It can be used, for example, to find bypassable edge-cases for firewalls and IDSs. [2.2]
- TCP Idle Scan (-sI) - the attacker sends a SYN-ACK packet to a host, which will be dubbed "unaware host" because its technical name, "zombie", already associates to a completely different meaning in the botnet context. The unexpected SYN-ACK packet sent to the unaware host will be responded to with a RST packet sent back to the attacker, which has a certain IP ID associated with it. The attacker then sends a SYN packet to the target host with the source IP address spoofed with the IP of the unaware host, incrementing its IP ID by 1. On this moment, there are three possible scenarios: (A1) The target host responds to the unaware host with a SYN-ACK packet. Since the unaware host was not expecting the packet, it sends a RST packet to the target host, incrementing its IP ID by 1 again. (A2) The target host responds to the unaware host with a RST packet. The unaware host did not expect the packet, but since it isn't a packet that tries to initiate a connection (rather, abort it), the unaware host does not respond with any packet, thus not incrementing its own IP ID. (A3) The target host does not respond to the unaware host. As such, the unaware host does not receive any packet and, more importantly, it doesn't send a packet back, such as in scenario A2, thus not incrementing its IP ID. Continuation: Once any of the previous scenarios has taken place, the attacker will send a SYN-ACK packet to the unaware host, to which the unaware host will respond with a RST packet. The IP ID of the final RST packet will then be analyzed by the attacker for the existence of one of the following scenarios: (B1) The IP ID was incremented by 2 since the first packet received from the unaware host, which means that the target host responded with a SYN-ACK packet to the unaware host, so the probed port is open. (B2) The IP ID was only incremented by 1 since the first packet received from the unaware host, which means that the target host responded with a RST packet or did not respond at all, since in both situations the unaware host does not create any response packet for the target host. As such, from the attacker's perspective, the probed port might be either closed (scenario A2) or filtered (scenario A3). The attacker then repeats this whole process for each port that he intends to scan. [2.2]
- TCP Maimon Scan (-sM) - this technique is named after its discoverer, Uriel Maimon. It starts with the attacker sending a TCP packet with the FIN and ACK flag bits set to each port. According to the RFC-793 (TCP RFC), the host should generate a RST packet in response, independently of the fact of the port being open or closed. However, Uriel found out that many BSD-derived systems simply drop this packet if the port is open. [2.2]
- FTP Bounce Scan (-b) - this method allows an attacker to use a vulnerable FTP server as a proxy to portscan other hosts. [2]
- SCTP INIT Scan (-sY) - the attacker sends an SCTP INIT packet to each port of the target host. An SCTP INIT-ACK response packet indicates that the port is open and, in this case, the attacker aborts the connection right after. An SCTP ABORT response packet indicates that the port is closed and, if no response is received after several retransmissions, the port is marked as filtered. [2.3]
- SCTP "COOKIE ECHO" Scan (-sZ) - the attacker sends an SCTP COOKIE ECHO packet to each port of the target host. If the target host doesn't respond, the port is either open or filtered. If the target host responds with an SCTP ABORT packet, then the port is closed. [2.3]

Tool Applicability: Any tool that communicates over a network can eventually be used for network host discovery using a certain network protocol, given that the probed protocol is present on the probed machine. Given the latter, we will only consider a host discovery tool as such if at least one of the following conditions are true:
- It supports sending and interpreting ARP probes for multiple hosts
- It supports sending and interpreting raw IP packets specifying the probed IP protocol number on the IP header for multiple hosts (IP-protocol probes)
- It supports sending and interpreting TCP, UDP and ICMP probes (given their prevalence on today's networks) for multiple hosts
Optionally, these tools can also support other much less adopted protocols such as SCTP. Also, the existence of any L5-7 protocol is irrelevant for this category.
Tools:
<name> (<L1-4 protocols supported>)
UnicornScan - 1, 2, 3 (TCP, UDP, ICMP)
Nmap - 1, 2, 3 (ARP, raw IP, ICMP, UDP, TCP, SCTP)
Ncat - 1, 2, 3, 4, 5 (UDP, TCP, SCTP)
Hping3 - 1, 2, 3, 4 (raw IP, ICMP, UDP, TCP)
AngryIPScanner - 1, 2 (ICMP, UDP, TCP)
Masscan - 1, 2 (ICMP, UDP, TCP)
ZMap - 1, 2 (ICMP, UDP, TCP)

3. L3 Threat Class - L3 Service Discovery
3.1. L3 Threat - IP Protocol Scan over IPv4 (-sO)
3.2. L3 Threat - IP Protocol Scan over IPv6
Intent: Find out information about a target host using L3 mechanisms.

Known Techniques:
- IP Protocol Scan over IPv4 (-sO) - the objective of this scan is determining what IP protocols, running over IPv4, are available in the target host. The attacker sends an IPv4 packet to the target host, with the "Protocol" field filled in the IPv4 header for each targeted IP protocol number. For example, the attacker can send six IP packets asking for six IP protocols support: ICMP (protocol 1), IGMP (protocol 2), IP-in-IP (protocol 4), TCP (protocol 6), UDP (protocol 17) and SCTP (protocol 132). If the attacker receives a response from the target host using the probed protocol or an ICMP port unreachable error (type 3, code 3), the protocol is supported (open). If an ICMP protocol unreachable error (type 3, code 2) is received, the protocol is marked as unsupported (closed). Other ICMP unreachable errors (type 3, code 0, 1, 9, 10, or 13) cause the protocol to be marked filtered. If no response is received after retransmissions, the protocol is marked as possibly supported (open or filtered). [3.1]
- IP Protocol Scan over IPv6 - the objective of this scan is determining what IP protocols, running over IPv6, are available in the target host. The attacker sends an IPv6 packet to the target host, with the "Next Header" field filled in the IP header for each targeted IP protocol number. Similarly to the IPv4 protocol scan, if the attacker receives a response from the target host using the probed protocol then the protocol is supported. However, the interpretation of the responses will differ since ICMPv4 and ICMPv6 responses differ. ICMPv6 response interpretation will not be contemplated in this work. [3.1]

Tool Applicability: Any tool that allows sending and interpreting multiple L3-related probes for a given host.
Tools:
<name> (<L1-4 protocols supported>)
Nmap - 1, 2, 3 (ARP, raw IP, ICMP, UDP, TCP, SCTP)
Hping3 - 1, 2, 3, 4 (raw IP, ICMP, UDP, TCP)

4. L4/L7 Threat Class - Network Resource Exhaustion Denial of Service Attack
4.1. L4 Threat - UDP Flood
4.2. L4 Threat - TCP Flood
4.3. L4 Threat - SCTP Flood
4.4. L4/L7 Threat - HTTP(S) Slow Flood
Intent: Exhaust the network resources of a target system by flooding it with multiple malicious requests.

Known Technique(s):
- Quick Network Resource Exhaustion - quickly and continuously launch multiple TCP/UDP requests against a target server. [4.1, 4.2]
- TCP SYN Flood - send multiple SYN packets to a target server, resulting in multiple SYN-ACK responses, only to never send any ACK back to the target server. If the attack is successful, it results in the target server maintaining multiple ports occupied for the initiated half-open connections, resulting in a denial of service for legitimate clients. [4.2]
- HTTP(S) Slow Network Resource Exhaustion - use the "connection: keep-alive" header of HTTP(S) requests to launch multiple parallel HTTP(S) persistent connections to the target server, slowly sending back to the server partial HTTP . This technique, usable against HTTP(S) applications, is similar to the TCP SYN Flood technique because it also maintains the TCP port occupied with the connection. However, rather than establishing multiple half-open TCP connections (L4) where the target server is left waiting for ACK packets, this technique establishes multiple full-open HTTP(S) connections (L7) where the target web server will have multiple threads holding on to each established connection. The attacker does this . Slowloris is an example of implementation of this technique. [4.2, 4.4]
- SCTP INIT Flood - TODO
- Denial of Service Amplification - use servers that are running network protocols such as DNS or NTP and, if applicable, take advantage of the fact that those servers' responses will have a much bigger length than the requests that are made. This fact gives an attacker the possibility of sending those servers multiple spoofed requests with the target's IP address as the source address in order to flood the unexpected target with those servers' TCP or UDP responses, resulting in a Distributed Denial of Service (DDoS) attack. [4]
- Distributed Denial of Service (DDoS) Attack - use multiple systems to attack a target system. [4]

Tool Applicability: TODO
Tools:
<name> (<L1-4 protocols supported>) (<L5-7 protocols supported>)
Ncat (UDP, TCP, SCTP) (None in particular)
Hping3 (raw IP, ICMP, UDP, TCP) (None in particular)
DoS Goldeneye (TCP) (HTTP/HTTPS)
DoS Hulk (TCP) (HTTP/HTTPS)
DoS Slowloris (TCP) (HTTP/HTTPS)

5. L1-7 Threat Class - Logical Denial of Service Attack
5.1. L1-7 Threat - Network Protocol Exploitation
5.2. L7 Threat - Application Layer Logical Exploitation

Intent: Exploit a network service or application running on the target system by performing specially crafted actions depending on the specific context.

Known Technique(s):
- Malformed Packet - this technique involves finding a bug or vulnerability in the used network protocol or in its code implementation, which means a network service running on the victim host is directly targeted. The attacks "Teardrop", "Land" and "Ping of Death" constitute examples of this technique. This technique highly depends on the exploitation of logical flaws in the implementation of a network protocol. [5.1]
- Application Layer Logical Exploitation - this technique uses logical mistakes in a specific application to cause its unavailability. As an example, if a server requires default guest user credentials to provide data to any user, all users must locally own those credentials (even if "under the hood") to authenticate to the server. As such, users might also be able to issue a password change request to the server to change those credentials if this "guest user" account is not treated with caution server-side. If no control is put in place for this situation, a single user could be able to deny every other user from authenticating to and receiving data from the servers, since every users' locally saved guest user credentials would not be valid anymore. [5.2]

Tool Applicability: Custom exploits.
Tools:
<name> (<L1-4 protocols supported>) (<L5-7 protocols supported>)
NA NA NA

6. L7 Threat Class - Brute Force Attack
6.1. L7 Threat - FTP Bruteforce
6.2. L7 Threat - SSH Bruteforce
6.3. L7 Threat - Telnet Bruteforce
6.4. L7 Threat - SMTP Bruteforce
6.5. L7 Threat - POP3 Bruteforce
6.6. L7 Threat - RDP Bruteforce
6.7. L7 Threat - HTTP Bruteforce (very dependent on the specific application)
6.8. L7 Threat - HTTPS Bruteforce (very dependent on the specific application)

Intent: Test multiple credential combinations in a continuous manner to find out correct ones.

Known Technique(s):
- Traditional Bruteforce Attack - test multiple passwords per few accounts. [6]
- Reverse Bruteforce Attack (a.k.a. Password Spraying Attack) - test few passwords per multiple accounts. [6]

Tool Applicability: Any tool that supports brute-forcing credentials associated with a L7 protocol.
Tools:
<name> (<L1-4 protocols supported>) (<L5-7 protocols supported>)
Ncat (UDP, TCP, SCTP) (None in particular)
Patator (TCP) (FTP, SSH, Telnet, SMTP, HTTP/HTTPS, RDP, AJP, POP, IMAP, LDAP, SMB, SNMP)
ncrack (TCP) (SSH, RDP, FTP, Telnet, HTTP/HTTPS (more specifically, it also supports Wordpress-based applications), POP3/POP3S, IMAP, CVS)
CrackMapExec (SMB)
