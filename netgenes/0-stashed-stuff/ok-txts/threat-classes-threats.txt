1. Threat Class - Host discovery

Intent: Probe a network range or multiple selected hosts to find active hosts.

Known Technique(s):
- ARP Ping Scan (-sn -PR) - within a Local Area Network (LAN), the attacker sends an ARP request to a destination MAC address, which can either be a single MAC address, a multicast MAC address or the broadcast MAC address (the most common). If any device is listening on those channels, it will respond (given a normal system configuration) to the request with a valid MAC address associated with the IP, in accordance with the respondent device's ARP table. This scan is very powerful to find hidden devices in a network, since ARP packets are usually responded to by whoever owns the requested information and is actively listening to those channels. In case of a response, we have confirmation that the host is active, unless the respondent host had ARP table entries that should already have expired or, in a more unusual case, if the respondent host was ARP spoofed. However, given that the request is usually broadcast, multiple responses may arrive so
- ICMP Echo Request Scan (-sn -PE) - for each host, the attacker sends an ICMP type 8 packet. If the host responds with an ICMP type 0 packet, it is up, else the host may be down or the packet was filtered.
- ICMP Timestamp Request Scan (-sn -PP) - for each host, the attacker sends an ICMP type 13 packet. If the host responds with an ICMP type 14 packet, it is up, else the host may be down or the packet was filtered.
- ICMP Information Request (does not exist in Nmap) - for each host, the attacker sends an ICMP type 15 packet. If the host responds with an ICMP type 16 packet, it is up, else the host may be down, this service is not implemented on the end device or the packet was filtered.
- ICMP Address Mask Request Scan (-sn -PM) - for each host, the attacker sends an ICMP type 17 packets. If the host responds with an ICMP type 18 packet, it is up, else the host may be down, this service is not implemented on the end device or the packet was filtered.
- UDP Ping Scan (-sn -PU) - for each host, the attacker sends a UDP request to one given port. If the host responds, the host is up, else the host may be down or the packet was filtered.
- TCP SYN Ping Scan (-sn -PS) - for each host, the attacker sends a TCP request with the SYN flag activated to one test port. If the host responds with SYN-ACK or RST, the host is up, else the host may be down or the packet was filtered.
- TCP ACK Ping Scan (-sn -PA) - for each host, the attacker sends a TCP request with the ACK flag activated to one test port. If the host responds with SYN-ACK or RST, the host is up, else the host may be down or the packet was filtered.
- IP Protocol Ping (-sn -PO) - for each host, the attacker sends multiple IP packets containing the IP protocol number in the IP header. For example, the attacker can send six packets: ICMP (protocol 1), IGMP (protocol 2), IP-in-IP (protocol 4), TCP (protocol 6), UDP (protocol 17) and SCTP (protocol 132). This method looks for either responses using the same protocol (host supports protocol) or ICMP protocol unreachable messages (host doesn't support protocol), both indicating that the the target host is alive.

2. Threat Class - Port Scan
2.1. Threat - UDP Port Scan
2.2. Threat - TCP Port Scan
2.3. Threat - SCTP Port Scan

Intent: Probe multiple ports of a given host, for a given L4 protocol.

Known Technique(s):
- UDP Scan (-sU) - the attacker sends a UDP packet to each port. If the target responds with service data, the port is open. If the target does not respond, the port is either closed or filtered.
- TCP Connect Scan - the attacker sends a TCP packet with the SYN flag bit set to each port. If the target responds with a SYN-ACK packet, the port is open and accepting requests: the attacker sends an ACK packet back; the target then responds with the service's specific data; then, the attacker sends a RST packet and closes the connection. If the target responds with a RST packet, the port is closed. Else, if the target does not respond, the port is filtered.
- TCP SYN Scan (-sS) - the attacker sends a TCP packet with the SYN flag bit set to each port. If the target responds with SYN-ACK, the port is open and accepting requests: the attacker sends a RST packet to close the connection. If the target responds with a RST packet, the port is closed. Else, if the target does not respond, the port is filtered.
- TCP ACK Scan (-sA) - the attacker sends a TCP packet with the ACK flag bit set to each port. If the target responds with a RST packet, the port is either open or closed, meaning that the port is unfiltered (not blocked by any firewall). Else, if the target does not respond or if it responds with certain ICMP error messages (type 3, code 0, 1, 2, 3, 9, 10 or 13), then the port is filtered.
- TCP Null Scan (-sN) - the attacker sends a TCP packet with no flag set to each port. If the target responds with a RST packet, the port is considered closed. Else, if the target does not respond, the port is either open or filtered. Finally, if the target responds with an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10 or 13) then the port is filtered.
- TCP Xmas Scan (-sX) - the attacker sends a TCP packet with the FIN, PSH and URG flag bits set to each port. If the target responds with a RST packet, the port is considered closed. Else, if the target does not respond, the port is either open or filtered. Finally, if the target responds with an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10 or 13) then the port is filtered.
- TCP FIN Scan (-sF) - the attacker sends a TCP packet with the FIN flag bit set to each port. If the target responds with a RST packet, the port is considered closed. Else, if the target does not respond, the port is either open or filtered. Finally, if the target responds with an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10 or 13) then the port is filtered.

Other techniques:
- TCP Window Scan (-sW) - this is not a technique that would alter the sent packet, rather an analysis technique for the other TCP port scans. The attacker may analyze the response packet to check whether a port is open: a positive window size indicates an open port and a zero size window indicates a closed port; if the response packet time to live (ttl) is lower than the rest of the received RST packets the port is likely to be open. This applies to most systems, but there are other systems that may return the inverse.
- TCP Custom Scan (--scanflags) - the attacker sends a TCP packet with a custom set of TCP flag bits set to each port. The analysis depends on the TCP flag set used, as this means different possible responses and interpretations.
- TCP Idle Scan (-sI) - TODO
- TCP Maimon Scan (-sM) - TODO
- FTP Bounce Scan (-b) - this method allows an attacker to use a vulnerable FTP server as a proxy to portscan other hosts.
- SCTP Init Scan (-sY) - TODO
- SCTP "Cookie Echo" Scan (-sZ) - TODO

3. Threat Class - Miscellaneous Host Scans
3.1. Threat - IP Protocol Scan (-sO)
Intent: Find out information about a target host (e.g. what IP protocols are running on it).

Known Techniques:
- IP Protocol Scan (-sO) - the attacker sends an IP packet with an IP protocol number filled in the IP header for each selected IP protocol number. For example, the attacker can send six packets: ICMP (protocol 1), IGMP (protocol 2), IP-in-IP (protocol 4), TCP (protocol 6), UDP (protocol 17) and SCTP (protocol 132). If the attacker receives a response in the probed protocol from the target host or an ICMP port unreachable error (type 3, code 3), the protocol is supported (open). If an ICMP protocol unreachable error (type 3, code 2) is received, the protocol is marked as unsupported (closed). Other ICMP unreachable errors (type 3, code 0, 1, 9, 10, or 13) cause the protocol to be marked filtered. If no response is received after retransmissions, the protocol is marked as possibly supported (open or filtered).


4. Threat Class - L1-L4 Denial of Service Attacks
4.1. Threat - UDP Flood Denial of Service
4.2. Threat - TCP Flood Denial of Service
4.3. Threat - Logical Denial of Service

Intent: Exhaust a target systems' network resources and/or computational resources by flooding it with multiple malicious requests.

Known Technique(s):
- Malformed Packet - this technique involves finding a bug or vulnerability in the used network protocol, service or application. Examples of this technique are the attacks "Teardrop", "Land" and "Ping of Death". This technique is comparable to application-based logical exploits that can disrupt the availability of a service. [4.3]
- Quick Resource Exhaustion - quickly and continuously launch multiple TCP/UDP requests against a target server. [4.1, 4.2]
- TCP SYN Flood - send multiple SYN packets to a target server, resulting in multiple SYN-ACK responses, only to never send any ACK back to the target server. If the attack is successful, it results in the target server maintaining multiple ports occupied for the initiated half-open connections, resulting in a denial of service for legitimate clients. [4.2]
- Slow HTTP Resource Exhaustion - use the "connection: keep-alive" header of HTTP/HTTPS requests to slowly launch multiple parallel HTTP/HTTPS connections to the target server. This technique is similar to the SYN Flood technique because it also maintains the port occupied with the connection, but rather than a half-open TCP connection, this is a full-open connection that operates at the HTTP/HTTPS protocol level (L7). [4.2, 4.3]
- Denial of Service Amplification - use servers that are running network protocols such as DNS or NTP and, if applicable, take advantage of the fact that those servers' responses will have a much bigger length than the requests that are made. This fact gives an attacker the possibility of sending those servers multiple spoofed requests with the target's IP address as the source address in order to flood the unexpected target with those servers' TCP or UDP responses. [4]
- Distributed Denial of Service - use multiple systems to attack a target system. [4]

5. Threat Class - L5-L7 Bruteforce
5.1. Threat - FTP Bruteforce
5.2. Threat - SSH Bruteforce
5.3. Threat - Telnet Bruteforce
5.4. Threat - SMTP Bruteforce
5.5. Threat - POP3 Bruteforce
5.6. Threat - RDP Bruteforce
5.7. Threat - HTTP Bruteforce (very dependent on specific application)
5.8. Threat - HTTPS Bruteforce (very dependent on specific application)

Intent: Test multiple credential combinations in a continuous manner to find out correct ones.

Known Technique(s):
- Traditional Bruteforce Attack - multiple passwords per few accounts. [5]
- Reverse Bruteforce Attack (a.k.a. Password Spraying Attack) - few passwords per multiple accounts. [5]





Tools:
NetDiscover
CrackMapExec
Nmap
Ncat
UnicornScan
AngryIPScanner
Ncrack
DoS Goldeneye
DoS Hulk
DoS Slowloris